<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Мини-приложение</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script> 
</head>
<body>
  <h1>Нажми "Забрать"</h1>
  <button onclick="claim()">Забрать</button>

  <script>
    function claim() {
      const user = Telegram.WebApp.initDataUnsafe?.user;
      if (!user) {
        alert("Ошибка: не удалось получить данные пользователя.");
        return;
      }

      fetch('https://slavka-bot-webhook.minuales.workers.dev/',  {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          user_id: user.id,
          event: 'claim_bonus',
          timestamp: new Date().toISOString()
        })
      })
      .then(() => {
        Telegram.WebApp.close(); // закрытие мини-приложения
      })
      .catch(err => {
        console.error("Ошибка:", err);
        alert("Ошибка при отправке данных");
      });
    }
  </script>
</body>
</html>
