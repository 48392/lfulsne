<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∞ –°–ª–æ—Ç –ú–∞—à–∏–Ω–∞ Mini App</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            text-align: center;
            max-width: 400px;
            width: 100%;
        }
        .title {
            color: #333;
            font-size: 24px;
            margin-bottom: 20px;
            font-weight: bold;
        }
        .slot-machine {
            background: #2c3e50;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 3px solid #34495e;
        }
        .slot-display {
            background: #ecf0f1;
            border-radius: 10px;
            padding: 15px;
            font-size: 32px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 20px;
            min-height: 60px;
            display: flex;
            justify-content: center;
            align-items: center;
            border: 2px solid #bdc3c7;
        }
        .spin-button, .bonus-button {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }
        .bonus-button {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        .spin-button:hover, .bonus-button:hover {
            transform: translateY(-2px);
        }
        .spin-button:active, .bonus-button:active {
            transform: translateY(0);
        }
        .status {
            margin-top: 20px;
            padding: 10px;
            border-radius: 10px;
            font-weight: bold;
        }
        .status.success {
            background: #d5f4e6;
            color: #27ae60;
            border: 2px solid #2ecc71;
        }
        .status.error {
            background: #fadbd8;
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }
        .status.info {
            background: #d6eaf8;
            color: #3498db;
            border: 2px solid #3498db;
        }
        .coins {
            background: linear-gradient(45deg, #f1c40f, #f39c12);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-weight: bold;
            margin: 10px 0;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">üé∞ –°–ª–æ—Ç –ú–∞—à–∏–Ω–∞</h1>
        <div class="coins">üí∞ –ú–æ–Ω–µ—Ç—ã: <span id="coins">1000</span></div>
        <div class="slot-machine">
            <div class="slot-display" id="slotDisplay">üé∞üé∞üé∞</div>
            <button class="spin-button" id="spinButton" onclick="spin()">üé≤ –ö—Ä—É—Ç–∏—Ç—å</button>
            <button class="bonus-button" id="bonusButton" onclick="claimBonus()">üéÅ –ó–∞–±—Ä–∞—Ç—å –±–æ–Ω—É—Å</button>
        </div>
        <div class="status info" id="status">
            –ì–æ—Ç–æ–≤ –∫ –∏–≥—Ä–µ! –ù–∞–∂–º–∏—Ç–µ "–ö—Ä—É—Ç–∏—Ç—å" —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å
        </div>
    </div>
    <script>
        let coins = 1000;
        let isSpinning = false;
        let lastResult = null;
        const symbols = ['üçé', 'üçä', 'üçá', 'üçí', 'üçã', 'üíé', '7Ô∏è‚É£', 'üé∞'];
        function updateCoins() {
            document.getElementById('coins').textContent = coins;
        }
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }
        function spin() {
            if (isSpinning) return;
            if (coins < 10) {
                updateStatus('–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –º–æ–Ω–µ—Ç!', 'error');
                return;
            }
            isSpinning = true;
            coins -= 10;
            updateCoins();
            const spinButton = document.getElementById('spinButton');
            const slotDisplay = document.getElementById('slotDisplay');
            spinButton.disabled = true;
            updateStatus('üé∞ –ö—Ä—É—Ç–∏–º...', 'info');
            let spinCount = 0;
            const spinInterval = setInterval(() => {
                const result = symbols[Math.floor(Math.random() * symbols.length)] +
                             symbols[Math.floor(Math.random() * symbols.length)] +
                             symbols[Math.floor(Math.random() * symbols.length)];
                slotDisplay.textContent = result;
                spinCount++;
                if (spinCount >= 10) {
                    clearInterval(spinInterval);
                    finishSpin();
                }
            }, 100);
        }
        function finishSpin() {
            const spinButton = document.getElementById('spinButton');
            const slotDisplay = document.getElementById('slotDisplay');
            isSpinning = false;
            spinButton.disabled = false;
            const symbol1 = symbols[Math.floor(Math.random() * symbols.length)];
            const symbol2 = symbols[Math.floor(Math.random() * symbols.length)];
            const symbol3 = symbols[Math.floor(Math.random() * symbols.length)];
            lastResult = symbol1 + symbol2 + symbol3;
            slotDisplay.textContent = lastResult;
            if (symbol1 === symbol2 && symbol2 === symbol3) {
                const winAmount = 100;
                coins += winAmount;
                updateStatus(`üéâ –î–ñ–ï–ö–ü–û–¢! –í—ã–∏–≥—Ä—ã—à: ${winAmount} –º–æ–Ω–µ—Ç!`, 'success');
            } else if (symbol1 === symbol2 || symbol2 === symbol3 || symbol1 === symbol3) {
                const winAmount = 20;
                coins += winAmount;
                updateStatus(`üéä –í—ã–∏–≥—Ä—ã—à: ${winAmount} –º–æ–Ω–µ—Ç!`, 'success');
            } else {
                updateStatus('üòî –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑!', 'error');
            }
            updateCoins();
        }
        async function claimBonus() {
            if (isSpinning) return;
            updateStatus('üéÅ –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –æ –±–æ–Ω—É—Å–µ...', 'info');
            // –ü–æ–ª—É—á–∞–µ–º –¥–∞–Ω–Ω—ã–µ Telegram WebApp
            const tg = window.Telegram?.WebApp;
            let user_id = null;
            let initData = null;
            if (tg && tg.initDataUnsafe && tg.initDataUnsafe.user && tg.initDataUnsafe.user.id) {
                user_id = tg.initDataUnsafe.user.id;
                initData = tg.initData;
            } else {
                updateStatus('‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å user_id –∏–∑ Telegram', 'error');
                return;
            }
            const bonusData = {
                user_id: user_id,
                miniapp: 'slot_machine_miniapp',
                event: 'claim_bonus',
                coins: coins,
                last_result: lastResult,
                timestamp: new Date().toISOString(),
                tgWebAppData: initData
            };
            try {
                // –ó–∞–º–µ–Ω–∏—Ç–µ URL –Ω–∞ –≤–∞—à —Å–µ—Ä–≤–µ—Ä!
                const response = await fetch('https://your-server.com/webhook', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(bonusData)
                });
                const result = await response.json();
                if (response.ok && result.status === 'success') {
                    updateStatus('‚úÖ –ë–æ–Ω—É—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Telegram', 'success');
                    // –ó–∞–∫—Ä—ã–≤–∞–µ–º –º–∏–Ω–∏–∞–ø–ø —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        if (tg && tg.close) tg.close();
                    }, 2000);
                } else {
                    throw new Error(result.message || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞');
                }
            } catch (error) {
                updateStatus(`‚ùå –û—à–∏–±–∫–∞: ${error.message}`, 'error');
            }
        }
        document.addEventListener('DOMContentLoaded', function() {
            updateStatus('üéÆ –ì–æ—Ç–æ–≤ –∫ –∏–≥—Ä–µ! –ù–∞–∂–º–∏—Ç–µ "–ö—Ä—É—Ç–∏—Ç—å"', 'info');
            if (window.Telegram && window.Telegram.WebApp) {
                window.Telegram.WebApp.ready();
            }
        });
    </script>
</body>
</html> 
